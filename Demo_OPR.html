


<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="style.css">
	<link rel="stylesheet" href="Style_FCFS.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/typed.js/2.0.11/typed.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
	<link rel="stylesheet"
		href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css" />
	<link rel="stylesheet" href="Style_OPR.css">
	<title>Optimal Page Replacement</title>
</head>


<body>
	<div class="scroll-up-btn">
		<i class="fas fa-angle-up"></i>
	</div>
	<nav class="navbar">
		<div class="max-width">
		  <div class="logo"><a href="index.html">Schedule<span>X.</span></a></div>
		  <ul class="menu">
			<li><a href="index.html" class="menu-btn">Home</a></li>
			<li><a href="About_peterson.html" class="menu-btn">About</a></li>
			<li><a href="index.html#services" class="menu-btn">Algorithms</a></li>
			<li><a href="" class="menu-btn">Guide</a></li>
			<li class="dropdown">
			  <a href="#" class="menu-btn" id="dropdown-btn">Theams       <i class="fas fa-caret-down"></i></a>
			  <ul class="dropdown-content" id="dropdown-content" style="width: 150px; background-color: white;">
				<li><a href="#" style="color: black;padding-left: 0px;padding-right: 0px; margin-left: 10px;" onclick="changeVideo('Videos/Demo_FCFS_Background.mp4')"><span class="rectangle"></span>Theam 1</a></li>
				<li><a href="#" style="color: black;padding-left: 0px;padding-right: 0px; margin-left: 10px;" onclick="changeVideo('Videos/Demo_Peterson_Background.mp4')"><span class="rectangle"></span>Theam 2</a></li>
				<li><a href="#" style="color: black;padding-left: 0px;padding-right: 0px; margin-left: 10px;" onclick="changeVideo('Videos/black-13495.mp4')"><span class="rectangle"></span>Theam 3</a></li>
				<li class="scrollable"><a href="#" style="color: black;padding-left: 0px;padding-right: 0px; margin-left: 10px;" onclick="changeVideo('Videos/production ID_4478322.mp4')"><span class="rectangle" ></span>Theam 4</a></li>
				<li class="scrollable"><a href="#" style="color: black;padding-left: 0px;padding-right: 0px; margin-left: 10px;" onclick="changeVideo('Videos/video.mp4')"><span class="rectangle" ></span>Theam 5</a></li>
				<li class="scrollable"><a href="#" style="color: black;padding-left: 0px;padding-right: 0px; margin-left: 10px;" onclick="changeVideo('Videos/network-80645.mp4')"><span class="rectangle" ></span>Theam 6</a></li>	
				<li><a href="#" style="color: black;padding-left: 0px;padding-right: 0px; margin-left: 10px;" onclick="changeVideo('Videos/dots-120172.mp4')"><span class="rectangle"></span>Original</a></li>
			  </ul>
			</li>
		  </ul>
		  <div class="menu-btn">
			<i class="fas fa-bars"></i>
		  </div>
		</div>
	  </nav>
	<video autoplay muted loop play-inline class="video" style="top:0px; left:auto;width: 1920px;" id="backgroundVideo">
		<source src="Videos/dots-120172.mp4" type="video/mp4">
	</video>
	<div class="pop-up">
		<div class="popup-overlay"></div>
		<div class="popup">
		  <h2>Welcome to<br> Optimal Page Replacement !</h2>
		  <p></p>
		  <ul>
			<li>want to know about this Simulator using</li><br>
			<li>
			  <div class="icon-container">
				<a href="Guide/Guide PDF/OPR Guide.pdf" target="_blank">
				  <img src="Guide/file-pdf-solid.svg" alt="" style="height: 80px;padding-right: 20px;padding-left: 30px;">
				</a>
				<div class="video-container">
				  <a class="video-text" onclick="showVideo()">
					<img src="Guide/video-solid.svg" alt="" style="height: 80px;padding-left: 150px;">
				  </a>
				  <div class="video-popup">
					<iframe width="560" height="315" src="Guide/Guide Videos/Optimal Page Replacement Scheduling.mp4" target="_blank" frameborder="0" allowfullscreen></iframe>
					<span class="close-button" onclick="closeVideo()" style="color:aliceblue">x</span>
				  </div>
				</div>
			  </div>
			</li>
		  </ul>
		  <button id="popup-close">Got it!</button>
		</div>
	  </div>
	<br><br><br><br>
	<h1>Optimal Page Replacement</h1><br>
	<form>
		<label for="pagesInput">Enter sequence of memory accesses:</label>
		<input type="text" id="pagesInput" name="pagesInput" onkeypress="return isNumberKey(event)" autocomplete="off"
			placeholder="Separated by comas(,)"><br>
		<label for="numFramesInput">Enter number of frames:</label>
		<input type="number" id="numFramesInput" name="numFramesInput" onkeypress="return isNumberKey(event)"><br><br>
		<button type="button" id="runAlgo">Run algorithm</button>
		<button id="reset" style="visibility: hidden;"><a href="Demo_OPR.html">Reset</a></button>
		<br>
		<br>
		<div id="frameDiv" style="overflow-x : scroll; overflow:auto">
			<table id="FrameTable" style="overflow-x: scroll;">
			</table>
		</div>
		<br>
		<div id="output"></div>
	</form>

</body>

<!-- Dropdown Script -->

<script>
	document.addEventListener('click', function(event) {
	  var dropdownBtn = document.getElementById('dropdown-btn');
	  var dropdownContent = document.getElementById('dropdown-content');
	  if (!dropdownBtn.contains(event.target)) {
		dropdownContent.style.display = 'none';
	  }
	});
	
	document.getElementById('dropdown-btn').addEventListener('click', function() {
	  var dropdownContent = document.getElementById('dropdown-content');
	  if (dropdownContent.style.display === 'block') {
		dropdownContent.style.display = 'none';
	  } else {
		dropdownContent.style.display = 'block';
	  }
	});
	</script>
  
  <!-- video Change Scritp  -->
  <script>
	function changeVideo(videoSrc) {
	  var video = document.getElementById('backgroundVideo');
	  video.src = videoSrc;
	  video.load();
	  video.play();
	}
  </script>
  
  
  <!-- POP up video script -->
  <script>
	function showVideo() {
	document.querySelector('.video-popup').style.display = 'block';
  }
  
  function closeVideo() {
	document.querySelector('.video-popup').style.display = 'none';
  }
  
  </script>
  
  <!-- script for pop-up -->
  <script>
	  const overlay = document.querySelector('.popup-overlay');
	  const popup = document.querySelector('.popup');
	  const closeBtn = document.getElementById('popup-close');
	  const h1 = document.getElementById('blure-h1');
	  const navbar = document.getElementById('navbar');
  
	  overlay.style.display = 'block';
	  popup.style.display = 'block';
	  
	  closeBtn.addEventListener('click', function() {
		overlay.style.display = 'none';
		popup.style.display = 'none';
		// h1.style.filter = 'blur(5px)';
		// navbar.style.filter = 'blure';
	  });
  </script>
  <script type="text/javascript">
	// Get the Trigger Button
	var triggerBtn = document.querySelector('.trigger-btn');
  
	// Get the Popup Container
	var popupContainer = document.querySelector('.popup-container');
  
	// Get the Close Button
	var popupClose = document.querySelector('.popup-close');
  
	// Add Event Listener to Trigger Button
	triggerBtn.addEventListener('click', function() {
	  popupContainer.style.display = 'block';
	});
  
	// Add Event Listener to Close Button
	popupClose.addEventListener('click', function() {
	  popupContainer.style.display = 'none';
	});
  
	// Add Event Listener to Outside of Popup Box
	window.addEventListener('click', function(event) {
	  if (event.target == popupContainer) {
		popupContainer.style.display = 'none';
	  }
	});
  </script>

  <!-- main code logic script start  -->
<script>
	let runAlgo = document.getElementById('runAlgo');
	let reset = document.getElementById('reset');

	runAlgo.addEventListener("click", function () {
		if (pagesInput.value == "" || numFramesInput.value == "") {
			alert("Please enter some query or head value");
			return;
		}

		
		if(pagesInput.value.includes(",,"))
		{
			alert("Do not use consecutive commas!");
			return;
		}

		if(pagesInput.value.slice(-1) == ",")
		{
			alert("Do not end with comma!");
			return;
		}

		optimalPageReplacement();
		runAlgo.style.display = "none";
		reset.style.visibility = "visible";
		pagesInput.disabled = "true";
		numFramesInput.disabled = "true";
	})

	// Function to check if the key pressed is a number or a comma
	function isNumberKey(evt) {
		// Get the ASCII value of the key that was pressed
		var charCode = (evt.which) ? evt.which : event.keyCode;

		// If the key is a digit or a comma, allow input
		if (charCode >= 48 && charCode <= 57 || charCode == 44) {
			return true;
		}

		// Otherwise, prevent input
		return false;
	}

	// Algorithm
	function optimalPageReplacement() {
		// Get the input values for the pages and number of frames
		let pagesInput = document.getElementById("pagesInput").value;
		let pages = pagesInput.split(",").map(Number);
		let numFramesInput = document.getElementById("numFramesInput").value;
		let numFrames = parseInt(numFramesInput);

		// Initialize variables for page hits, page faults, and the frame table
		let pageHits = 0;
		let pageFaults = 0;
		let FrameTable = document.getElementById("FrameTable");

		// Create an empty array to hold the frames
		let frames = [];

		// Add a row to the frame table for each frame, with a label indicating its index
		for (let i = 0; i < numFrames; i++) {
			let row = FrameTable.insertRow(-1);
			let cell = row.insertCell(-1);
			cell.innerHTML = `Frame [${i + 1}]`;
		}

		// Add a row to the frame table to indicate the status (hit or miss) of each page request
		statusrow = FrameTable.insertRow(-1);
		statusrow.insertCell(-1).innerHTML = null;

		// Loop through each page in the input
		for (let i = 0; i < pages.length; i++) {
			let page = pages[i];

			// If the page is already in one of the frames, mark it as a hit
			if (frames.includes(page)) {

				// Loop through each frame and add it to the frame table
				for (let k = 0; k < numFrames; k++) {

					let cell = FrameTable.rows[k].insertCell();
					if (frames[k] != undefined) {
						cell.innerHTML = frames[k];
					}

					// If the current frame is the same as the current page, highlight it in red
					if (page == frames[k]) {
						cell.style.color = "red";
					}

				}

				// Add "Hit" to the status row, increment the page hit counter, and move on to the next page
				statusrow.insertCell(-1).innerHTML = "Hit";
				pageHits++;
				continue;


			}

			// If the frame does not contain the page, it's a miss
			else {
				pageFaults++;
				if (frames.length < numFrames) {
					frames.push(page);
					for (let k = 0; k < numFrames; k++) {

						let cell = FrameTable.rows[k].insertCell();
						if (frames[k] != undefined) {
							cell.innerHTML = frames[k];
						}
					}
					statusrow.insertCell(-1).innerHTML = "Miss";
				}

				else {
					let index = -1;
					let farthest = i + 1;
					// Loop through each frame to find the least recently used one
					for (let j = 0; j < frames.length; j++) {
						let frame = frames[j];

						//look for the next time this page is used
						let futureIndex = pages.indexOf(frame, i);

						// if page is not found in future, select this frame for replacement
						if (futureIndex == -1) {
							index = j;
							break;
						}

						// If the page is found in future and its next occurrence is farthest, select this frame for replacement
						if (futureIndex > farthest) {
							farthest = futureIndex;
							index = j;
						}
					}
			
					// Replace the least recently used frame with the current page
					frames[index] = page;

					// Loop through each frame and add it to the table
					for (let k = 0; k < numFrames; k++) {
						let cell = FrameTable.rows[k].insertCell();
						if (frames[k] != undefined) {
							cell.innerHTML = frames[k];
						}
						if (frames[k] == page) {
							cell.style.color = "green";
						}
						// if(frames[k]== undefined){
						// 	cell.innerHTML = "-";
						// }
					}
					// Add "Miss" to the status row, increment the page fault counter
					statusrow.insertCell(-1).innerHTML = "Miss";
				}
			}
		}
		let totalRequests = pageHits + pageFaults;
		let hitRatio = (pageHits / totalRequests) * 100;
		let missRatio = (pageFaults / totalRequests) * 100;

		// Display the results in the "output" element
		document.getElementById("output").innerHTML = `Total number of pages: ${totalRequests}<br>`
			+ `Number of page hits: ${pageHits}<br>`
			+ `Number of page faults: ${pageFaults}<br>`
			+ `Hit ratio: ${hitRatio.toFixed(2)}%<br>`
			+ `Miss ratio: ${missRatio.toFixed(2)}%`;

		fetch("http://localhost:5500/opr", {
			method: 'POST',             // use HTTP POST method to send data to server
			headers: {                  // set content type to JSON
				'Content-Type': 'application/json',
			},
			body: JSON.stringify({     // convert data into a JSON string
				pages: String(pagesInput),
				numFrames: numFrames,
				pageHits: pageHits,
				pageFaults: pageFaults,
				totalRequests: totalRequests,
				missRatio: String(missRatio.toFixed(2) + "%"),
				hitRatio: String(hitRatio.toFixed(2) + "%"),
			}),
		}).then((response) => response.json())    // parse response as JSON
			.then((data) => {                       // handle successful response
				console.log('Success:', data);
			})
			.catch((error) => {                     // handle error
				console.error('Error:', error);
			});
	}
</script>
<script src="Script/script.js"></script>
</html>





